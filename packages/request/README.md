# miniprogram-request [![npm version](https://badge.fury.io/js/miniprogram-request.svg)](https://npmjs.com/package/miniprogram-request)

> A better Request package for MiniProgram API
>
> 小程序请求封装


Features
  
* [ ] Promise
* [ ] Cancelable
* [ ] Queue
* [ ] Wx request params
    * [ ] timeout
    * [ ] datatype
* [ ] Retry when network failure
* [ ] Configuration
    * [ ] BaseUri
    * [ ] Authentication
    * [ ] ...
* [ ] Interceptors in Lifecycle (only one,modify data or status)
    * [ ] transform request data
    * [ ] transform response data
* [ ] Listeners
    * [ ] On Send (before request data send & after request data transformed)
    * [ ] On Response (after request response data transformed)
    * [ ] On resolved (before `then` of Promise)
    * [ ] On rejected (before `catch` of Promise)
    * [ ] On abort
    * [ ] On complete
* [ ] On Progress?
* [ ] lock/unlock





### Lifecycle

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" fill-rule="evenodd" stroke-linecap="square" stroke-miterlimit="3" color-interpolation-filters="sRGB" font-size="12" overflow="visible" viewBox="0 0 841.89 595.276"><style>.st1{fill:#43beb9;stroke:#c8c8c8;stroke-width:.25}.st2{fill:#feffff;font-family:Calibri;font-size:1.00001em}.st3{font-size:1em}.st4,.st6{marker-end:url(#mrkr4-14);stroke:#45b664;stroke-linecap:round;stroke-linejoin:round;stroke-width:2.25}.st6{marker-end:url(#mrkr4-32);stroke-width:1}.st8{fill:#fff;stroke:none;stroke-linecap:butt;stroke-width:7.2}.st9{fill:#3b9f57;font-family:Calibri;font-size:1.00001em}.st10{fill:#fff}.st11{stroke:#4672c4;stroke-width:.75}.st12,.st13{fill:#4672c4;font-family:Calibri;font-size:1.00001em}.st13{fill:#3ca057}.st15{stroke:#c8c8c8;stroke-width:.25}.st16{fill:#000;font-family:Calibri;font-size:1.00001em}.st17,.st20{fill:url(#grad0-64);stroke:#2f528f;stroke-width:.75}.st20{fill:url(#grad0-129);stroke:#308547}.st21{marker-end:url(#mrkr4-136);stroke:#c00000;stroke-linecap:round;stroke-linejoin:round;stroke-width:1}</style><defs id="Patterns_And_Gradients"><linearGradient id="grad0-64" x2="1" gradientTransform="rotate(250 .5 .5)"><stop offset="0" stop-color="#3a63ac"/><stop offset=".48" stop-color="#3a63ac"/><stop offset=".82" stop-color="#4472c4"/></linearGradient><linearGradient id="grad0-77" x2="1" gradientTransform="rotate(250 .5 .5)"><stop offset="0" stop-color="#39a6a2"/><stop offset=".48" stop-color="#39a6a2"/><stop offset=".82" stop-color="#43beb9"/></linearGradient><linearGradient id="grad0-129" x2="1" gradientTransform="rotate(250 .5 .5)"><stop offset="0" stop-color="#3b9f57"/><stop offset=".48" stop-color="#3b9f57"/><stop offset=".82" stop-color="#45b664"/></linearGradient></defs><defs id="Markers"><path id="lend4" d="M2 1L0 0l2-1v2"/><marker id="mrkr4-14" fill="#45b664" stroke="#45b664" stroke-width=".472" orient="auto" overflow="visible" refX="-4.24"><use transform="scale(-2.12)" xlink:href="#lend4"/></marker><marker id="mrkr4-32" fill="#45b664" stroke="#45b664" stroke-width=".284" orient="auto" overflow="visible" refX="-7.04"><use transform="scale(-3.52)" xlink:href="#lend4"/></marker><marker id="mrkr4-136" fill="#c00000" stroke="#c00000" stroke-width=".284" orient="auto" overflow="visible" refX="-7.04"><use transform="scale(-3.52)" xlink:href="#lend4"/></marker></defs><g id="shape1-1" transform="translate(195.048 -459.635)"><path d="M0 546.061h72.374v49.214H0z" class="st1"/><text x="20.04" y="559.87" class="st2">Create <tspan x="17.46" class="st3" dy="1.2em">request </tspan><tspan x="13.89" class="st3" dy="1.2em">data(obj)</tspan></text></g><g id="shape2-6" transform="translate(87.934 -469.767)"><path d="M14.47 595.28H57.9a14.475 14.475-180 0 0 0-28.95H14.47a14.475 14.475-180 1 0 0 28.95z" class="st1"/><text x="24.85" y="584.4" class="st2">start</text></g><g id="shape5-9" transform="translate(267.422 -477.155)"><path d="M0 588.19h27.37" class="st4"/></g><g id="shape4-15" transform="translate(304.332 -459.635)"><path d="M0 546.061h105.274v49.214H0z" class="st1"/><text x="12.45" y="567.07" class="st2">RequestTransfer <tspan x="3.41" class="st3" dy="1.2em">(data,header?,this?)</tspan></text></g><g id="shape8-19" transform="translate(409.606 -491.329)"><path d="M0 602.36h24.14" class="st4"/></g><g id="shape7-24" transform="translate(443.29 -462.53)"><path d="M0 551.851h72.374v43.424H0z" class="st1"/><text x="2.89" y="577.16" class="st2">Send Request</text></g><g id="shape10-27" transform="translate(472.391 -462.53)"><path d="M7.09 595.28v43.62" class="st6"/><path d="M3.313 613.407h7.547v14.4H3.313z" class="st8"/><text x="3.31" y="624.21" class="st9">{}</text></g><g id="shape9-35" transform="translate(443.29 -368.444)"><path d="M0 595.28h72.37v-43.43H0v43.43z" class="st10"/><path d="M0 595.28h72.37v-43.43H0v43.43M8.5 595.28v-43.43M63.87 595.28v-43.43" class="st11"/><text x="17.01" y="569.96" class="st12">OnSend <tspan x="15.51" class="st3" dy="1.2em">listeners</tspan></text></g><g id="shape12-42" transform="translate(515.664 -484.242)"><path d="M0 595.28h97.7v62.83" class="st4"/><path d="M73.288 588.076H96.79v14.4H73.288z" class="st8"/><text x="73.29" y="598.88" class="st13">Push</text></g><g id="shape11-49" transform="translate(577.182 -272.91)"><path fill="#cbffff" d="M0 595.28h72.37V456.32H0v138.96z"/><path d="M0 595.28h72.37V456.32H0v138.96M8.5 595.28V456.32M63.87 595.28V456.32" class="st15"/><text x="16.3" y="522.2" class="st16">Request <tspan x="19.87" class="st3" dy="1.2em">Queue</tspan></text></g><g id="shape14-56" transform="translate(606.282 -272.91)"><path d="M7.09 595.28v22.3" class="st4"/></g><g id="shape13-61" transform="translate(572.116 -194.746)"><path d="M0 572.12l41.25-23.16 41.26 23.16-41.26 23.16L0 572.12z" class="st17"/><text x="21.36" y="568.52" class="st2">Request <tspan x="14.08" class="st3" dy="1.2em">successed?</tspan></text></g><g id="shape16-67" transform="translate(654.622 -211.543)"><path d="M0 588.91h21.26v-1.44h10.06" class="st6"/><path d="M11.518 581.713h16.77v14.4h-16.77z" class="st8"/><text x="11.52" y="592.51" class="st9">Fail</text></g><g id="shape15-74" transform="translate(692.98 -197.641)"><path fill="url(#grad0-77)" stroke="#2f8b87" stroke-width=".75" d="M0 573.56l36.19-21.71 36.18 21.71-36.18 21.72L0 573.56z"/><text x="14.32" y="577.16" class="st2">Retry&gt;0?</text></g><g id="shape18-79" transform="translate(736.254 -241.065)"><path d="M-7.09 595.28v-47.97" class="st6"/><path d="M-15.342 560.574H1.17v14.4h-16.512z" class="st8"/><text x="-15.34" y="571.37" class="st9">Yes</text></g><g id="shape17-86" transform="translate(698.77 -296.07)"><path d="M0 551.851h60.794v43.424H0z" class="st1"/><text x="12.52" y="577.16" class="st2">Resend</text></g><g id="shape20-89" transform="translate(729.167 -339.494)"><path d="M0 595.28v-93.64h-115.8v14.22" class="st6"/><path d="M-38.447 494.442h33.469v14.4h-33.469z" class="st8"/><text x="-38.45" y="505.24" class="st9">Retry--</text></g><g id="shape24-96" transform="translate(572.116 -211.543)"><path d="M0 588.91h-21.26v-1.44h-20.59" class="st4"/><path d="M-43.631 580.265h37.325v14.4h-37.325z" class="st8"/><text x="-43.63" y="591.07" class="st13">Success</text></g><g id="shape23-103" transform="translate(438.224 -194.746)"><path d="M0 546.061h82.506v49.214H0z" class="st17"/><text x="2.64" y="559.87" class="st2">ResponseTransf<tspan x="36.18" class="st3" dy="1.2em">er </tspan><tspan x="17.03" class="st3" dy="1.2em">(res,this?)</tspan></text></g><g id="shape28-109" transform="translate(438.224 -212.267)"><path d="M0 588.19h-30.93" class="st4"/></g><g id="shape27-114" transform="translate(320.315 -194.746)"><path d="M0 570.67l38.72-24.61 38.72 24.61-38.72 24.61L0 570.67z" class="st17"/><text x="8.81" y="574.66" class="st2">Exception<tspan font-family="黑体" font-size="1em">？</tspan></text></g><g id="shape30-119" transform="translate(351.948 -243.96)"><path d="M7.09 595.28V555.6" class="st4"/><path d="M.049 563.469h14.074v14.4H.049z" class="st8"/><text x=".05" y="574.27" class="st13">No</text></g><g id="shape29-126" transform="translate(320.315 -293.175)"><path d="M0 551.851h77.44v43.424H0z" class="st20"/><text x="5.34" y="577.16" class="st2">Resolve(data)</text></g><g id="shape33-131" transform="translate(352.356 -194.746)"><path d="M6.68 595.28v21.26h.81v20.91" class="st21"/><path fill="#fff" stroke-linecap="butt" d="M-.762 612.276H15.75v14.4H-.762z"/><text x="-.76" y="623.08" class="st16">Yes</text></g><g id="shape32-139" transform="translate(90.83 -204.879)"><path d="M14.47 595.28H57.9a14.475 14.475-180 0 0 0-28.95H14.47a14.475 14.475-180 1 0 0 28.95z" class="st17"/><text x="26.95" y="584.4" class="st2">End</text></g><g id="shape36-143" transform="translate(160.308 -477.155)"><path d="M0 588.19h27.7" class="st6"/></g><g id="shape38-148" transform="translate(472.391 -243.96)"><path d="M7.09 595.28V553.1" class="st6"/><path d="M-.337 563.469h14.848v14.4H-.337z" class="st8"/><text x="-.34" y="574.27" class="st9">res</text></g><g id="shape37-155" transform="translate(438.224 -293.175)"><path d="M0 595.28h82.51v-49.22H0v49.22z" class="st10"/><path d="M0 595.28h82.51v-49.22H0v49.22M8.5 595.28v-49.22M74 595.28v-49.22" class="st11"/><text x="10.74" y="567.07" class="st12">OnResponse <tspan x="19.44" class="st3" dy="1.2em">Listeners</tspan></text></g><g id="shape39-162" transform="translate(318.596 -102.108)"><path fill="#ef7d31" stroke="#c8c8c8" stroke-width=".25" d="M0 551.851h82.506v43.424H0z"/><text x="5.79" y="577.16" class="st2">Reject(reason)</text></g><g id="shape42-165" transform="translate(401.102 -116.733)"><path d="M0 588.19h35.87" class="st6"/></g><g id="shape41-170" transform="translate(444.014 -99.213)"><path d="M0 595.28h82.51v-49.22H0v49.22z" class="st10"/><path d="M0 595.28h82.51v-49.22H0v49.22M8.5 595.28v-49.22M74 595.28v-49.22" class="st11"/><text x="12.78" y="567.07" class="st12">OnRejected <tspan x="19.44" class="st3" dy="1.2em">Listeners</tspan></text></g><g id="shape44-177" transform="translate(351.948 -336.599)"><path d="M7.09 595.28v-21.91" class="st6"/></g><g id="shape43-182" transform="translate(317.42 -365.549)"><path d="M0 595.28h83.23v-49.22H0v49.22z" class="st10"/><path d="M0 595.28h83.23v-49.22H0v49.22M8.5 595.28v-49.22M74.73 595.28v-49.22" class="st11"/><text x="15.66" y="567.07" class="st12">OnResolve <tspan x="19.8" class="st3" dy="1.2em">Listeners</tspan></text></g><g id="shape47-189" transform="translate(320.315 -314.887)"><path d="M0 595.28h-25.51v95.53h-36.66" class="st4"/></g><g id="shape46-194" transform="translate(200.838 -197.641)"><path d="M0 551.851h47.767v43.424H0z" class="st20"/><text x="8.25" y="577.16" class="st2">Finally</text></g><g id="shape48-198" transform="translate(318.596 -123.82)"><path d="M0 595.28h-22.85v-95.54h-40.1" class="st21"/></g><g id="shape49-203" transform="translate(200.838 -226.44)"><path d="M0 602.36h-28.09" class="st4"/></g><g id="shape51-208" transform="translate(217.68 -197.641)"><path d="M7.04 595.28v21.26h.09v20.91" class="st6"/></g><g id="shape50-213" transform="translate(178.583 -99.213)"><path d="M0 595.28h92.46v-49.22H0v49.22z" class="st10"/><path d="M0 595.28h92.46v-49.22H0v49.22M8.5 595.28v-49.22M83.95 595.28v-49.22" class="st11"/><text x="15.44" y="567.07" class="st12">OnComplete <tspan x="24.41" class="st3" dy="1.2em">Listeners</tspan></text></g><g id="shape57-220" transform="translate(729.167 -197.641)"><path d="M0 595.28v30.84h-369.32v14.22" class="st21"/><path d="M-186.901 618.925h14.074v14.4h-14.074z" class="st8"/><text x="-186.9" y="629.73" class="st16">No</text></g><g id="shape60-227" transform="translate(188.534 -288.832)"><path fill="#ffc000" stroke="#c8c8c8" stroke-width=".25" d="M17.01 595.28h38.36l17-21.72-17-21.71H17.01L0 573.56l17.01 21.72z"/><text x="22.89" y="577.16" class="st2">abort</text></g><g id="shape62-230" transform="translate(217.634 -332.257)"><path d="M7.09 595.28v-26.26" class="st6"/></g><g id="shape61-235" transform="translate(188.534 -365.549)"><path d="M0 595.28h72.37v-49.22H0v49.22z" class="st10"/><path d="M0 595.28h72.37v-49.22H0v49.22M8.5 595.28v-49.22M63.87 595.28v-49.22" class="st11"/><text x="15.17" y="567.07" class="st12">OnAbort <tspan x="11.22" class="st3" dy="1.2em">Listenners</tspan></text></g><g id="shape63-242" transform="translate(217.634 -288.832)"><path d="M7.09 595.28V636" class="st6"/></g></svg>